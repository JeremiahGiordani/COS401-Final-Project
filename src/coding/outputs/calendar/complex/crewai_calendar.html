<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Calendar Scheduling Interface</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(17, 2.5rem);
            gap: 1px;
            background-color: #ccc;
        }
        .calendar div {
            background-color: #fff;
            border: 1px solid #ddd;
            position: relative;
        }
        .time-slot {
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #ddd;
        }
        .weekday-header {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .event {
            position: absolute;
            background-color: #87ceeb;
            border: 1px solid #007bff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
        }
        .time-indicator {
            position: absolute;
            width: calc(100% + 2px);
            height: 2px;
            background-color: red;
            z-index: 1000;
            top: 0;
        }
    </style>
</head>
<body>
    <div>
        <button id="btnToday">Today</button>
    </div>
    <div class="calendar" id="calendar"></div>

    <script>
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        const calendarEl = document.getElementById('calendar');
        const btnToday = document.getElementById('btnToday');
        let events = [];
        let isDraggingEvent = false;
        let dragEvent = null;
        let startX, startY, startRow, startCol;
        const dayStartHour = 9;
        const dayEndHour = 17;
        const timeSlotsPerHour = 2;
        const totalSlots = (dayEndHour - dayStartHour) * timeSlotsPerHour;

        function createCalendar() {
            // Create header for weekdays
            days.forEach(day => {
                const header = document.createElement('div');
                header.classList.add('weekday-header');
                header.innerText = day;
                calendarEl.appendChild(header);
            });

            // Create time slots
            for (let i = 0; i < totalSlots; i++) {
                days.forEach(() => {
                    const timeSlot = document.createElement('div');
                    timeSlot.classList.add('time-slot');
                    timeSlot.dataset.time = `${Math.floor(i / timeSlotsPerHour) + dayStartHour}:${i % timeSlotsPerHour === 0 ? '00' : '30'}`;
                    calendarEl.appendChild(timeSlot);
                });
            }
        }

        function getGridPosition(event) {
            const rect = calendarEl.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            return { x: x, y: y };
        }

        function startEventCreation(event) {
            const { x, y } = getGridPosition(event);
            startX = x;
            startY = y;
            startRow = Math.floor(y / (rect.height / totalSlots));
            startCol = Math.floor(x / (rect.width / days.length));
            isDraggingEvent = true;
            dragEvent = {
                startRow,
                startCol,
                duration: 1,
                element: createEventElement(startRow, startCol, 1)
            };
        }

        function createEventElement(row, col, duration) {
            const timeSlot = calendarEl.children[row * days.length + col];
            const eventEl = document.createElement('div');
            eventEl.classList.add('event');
            updateEventElement(eventEl, row, duration);
            calendarEl.appendChild(eventEl);
            draggingEventElement = eventEl;
            return eventEl;
        }

        function updateEventElement(eventEl, row, duration) {
            const start = dayStartHour + Math.floor(row / timeSlotsPerHour);
            const startMinutes = (row % timeSlotsPerHour) * 30;
            const end = dayStartHour + Math.floor((row + duration) / timeSlotsPerHour);
            const endMinutes = ((row + duration) % timeSlotsPerHour) * 30;
            eventEl.style.gridRowStart = row + 2;  // Adjust for header row
            eventEl.style.gridRowEnd = eventEl.style.gridRowStart + duration;
            eventEl.innerText = `${start}:${startMinutes.toString().padStart(2, '0')} - ${end}:${endMinutes.toString().padStart(2, '0')}`;
        }

        function stopEventCreation(event) {
            isDraggingEvent = false;
            // Confirm and finalize the event
        }

        function highlightTimeRange(event) {
            if (!isDraggingEvent) return;
            const { x: endX, y: endY } = getGridPosition(event);
            const endRow = Math.floor(endY / (rect.height / totalSlots));
            const duration = Math.abs(endRow - startRow) + 1;
            dragEvent.duration = duration;
            updateEventElement(dragEvent.element, startRow, duration);
        }

        function initEventListeners() {
            calendarEl.addEventListener('mousedown', startEventCreation);
            document.addEventListener('mousemove', highlightTimeRange);
            document.addEventListener('mouseup', stopEventCreation);
        }

        createCalendar();
        initEventListeners();
    </script>
</body>
</html>