<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Calendar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .calendar-container {
            display: grid;
            grid-template-columns: 100px repeat(5, 1fr);
            grid-template-rows: repeat(17, 40px);
            gap: 1px;
            position: relative;
        }
        .time-slot {
            border: 1px solid #ccc;
            position: relative;
        }
        .time-label {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
        }
        .event {
            background: #48C9B0;
            color: #fff;
            position: absolute;
            z-index: 1;
            padding: 5px;
            box-sizing: border-box;
            cursor: pointer;
        }
        .highlight {
            position: absolute;
            background: rgba(72,201,176,0.3);
            z-index: 0;
        }
        .today-marker {
            position: absolute;
            width: 100%;
            border-top: 2px dashed red;
            z-index: 2;
        }
        @media (max-width: 600px) {
            .calendar-container {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(5, auto);
            }
        }
    </style>
</head>
<body>
    <button id="today-button">Today</button>
    <div class="calendar-container" id="calendar">
        <div class="time-label"></div>
        <div class="time-label">Monday</div>
        <div class="time-label">Tuesday</div>
        <div class="time-label">Wednesday</div>
        <div class="time-label">Thursday</div>
        <div class="time-label">Friday</div>
        <div class="time-label">9:00 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">9:30 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">10:00 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">10:30 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">11:00 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">11:30 AM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">12:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">12:30 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">1:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">1:30 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">2:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">2:30 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">3:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">3:30 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">4:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">4:30 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
        <div class="time-label">5:00 PM</div>
        <div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div><div class="time-slot"></div>
    </div>

    <script>
        const calendar = document.getElementById('calendar');
        const todayButton = document.getElementById('today-button');
        const startHour = 9, endHour = 17, slotHeight = 40;
        let isDragging = false, isResizing = false, currentEvent = null, startY = 0, highlightBox = null;

        function createEvent(element, start, end, day) {
            const event = document.createElement('div');
            event.classList.add('event');
            event.style.top = `${start * slotHeight}px`;
            event.style.height = `${(end - start) * slotHeight}px`;
            event.style.left = `${(day + 1) * 100}px`;
            event.style.width = 'calc(100% - 100px)';
            event.innerHTML = `${formatTime(start + startHour)} - ${formatTime(end + startHour)}`;
            event.dataset.start = start;
            event.dataset.end = end;
            event.dataset.day = day;

            event.addEventListener('click', () => {
                if (confirm('Do you want to delete this event?')) {
                    event.remove();
                }
            });

            event.addEventListener('mousedown', (e) => {
                if (!isResizing) {
                    isDragging = true;
                    currentEvent = event;
                    startY = e.clientY;
                }
            });
            
            event.addEventListener('dblclick', () => {
                const eventName = prompt('Enter event name:', 'New Event');
                if (eventName) {
                    event.innerText = eventName;
                    event.innerHTML = `${eventName}<br>${formatTime(start + startHour)} - ${formatTime(end + startHour)}`;
                }
            });
            calendar.appendChild(event);

            return event;
        }

        function formatTime(hours) {
            const h = Math.floor(hours);
            const m = (hours - h) * 60;
            const period = h >= 12 ? 'PM' : 'AM';
            return `${((h - 1) % 12 + 1)}:${m < 10 ? '0' + m : m} ${period}`;
        }

        function showCurrentTime() {
            const now = new Date();
            const currentTime = now.getHours() + (now.getMinutes() / 60) - startHour;
            if (currentTime >= 0 && currentTime <= endHour - startHour) {
                const line = document.createElement('div');
                line.classList.add('today-marker');
                line.style.top = `${currentTime * slotHeight}px`;
                calendar.appendChild(line);
            }
        }

        calendar.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('time-slot')) {
                isDragging = true;
                startY = e.clientY;
                const day = Math.floor((e.clientX - 100) / 200);
                const start = Math.floor((e.clientY - calendar.getBoundingClientRect().top) / slotHeight);
                const div = document.createElement('div');
                div.classList.add('highlight');
                div.style.top = `${start * slotHeight}px`;
                div.style.height = `${slotHeight}px`;
                div.style.left = `${(day + 1) * 100}px`;
                calendar.appendChild(div);
                highlightBox = div;
                highlightBox.dataset.start = start;
                highlightBox.dataset.day = day;
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging && highlightBox) {
                const y = e.clientY;
                const end = Math.floor((y - calendar.getBoundingClientRect().top) / slotHeight);
                const start = parseInt(highlightBox.dataset.start);
                const height = (end - start + 1) * slotHeight;
                highlightBox.style.height = `${Math.abs(height)}px`;
                if (height < 0) {
                    highlightBox.style.top = `${end * slotHeight}px`;
                }
            } else if (isResizing && currentEvent) {
                const y = e.clientY;
                let height = currentEvent.offsetHeight + (y - startY);
                height = Math.round(height / slotHeight) * slotHeight;
                currentEvent.style.height = `${height}px`;
                currentEvent.dataset.end = parseInt(currentEvent.dataset.start) + (height / slotHeight);
                currentEvent.innerHTML = `${currentEvent.innerText.split('<br>')[0]}<br>${formatTime(currentEvent.dataset.start + startHour)} - ${formatTime(currentEvent.dataset.end + startHour)}`;
                startY = y;
            }
        });

        document.addEventListener('mouseup', () => {
            if (isDragging && highlightBox) {
                const start = parseInt(highlightBox.dataset.start);
                const day = parseInt(highlightBox.dataset.day);
                const end = Math.floor((highlightBox.offsetTop + highlightBox.offsetHeight) / slotHeight);
                if (end > start) {
                    createEvent(highlightBox, start, end, day);
                }
                calendar.removeChild(highlightBox);
                highlightBox = null;
            }

            isDragging = false;
            isResizing = false;
            currentEvent = null;
        });

        todayButton.addEventListener('click', () => {
            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();
            const calendarTop = (currentTime - (startHour * 60)) * slotHeight / 30;
            window.scrollTo(0, calendarTop);
        });

        showCurrentTime();
    </script>
</body>
</html>