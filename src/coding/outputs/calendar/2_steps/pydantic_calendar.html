<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Calendar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #calendar-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: auto 1fr;
            width: 90%;
            max-width: 1200px;
            background: white;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .calendar-header {
            display: contents;
        }
        .weekday {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: #f7f7f7;
            border-bottom: 1px solid #ccc;
        }
        .calendar-body {
            display: contents;
        }
        .time-slot {
            border-bottom: 1px solid #eee;
            border-right: 1px solid #ccc;
            min-height: 30px;
            position: relative;
        }
        .event {
            position: absolute;
            background: rgba(0, 123, 255, 0.75);
            color: white;
            border-radius: 4px;
            padding: 4px;
            cursor: pointer;
            user-select: none;
        }
        .highlight {
            background: rgba(0, 123, 255, 0.25);
        }
    </style>
</head>
<body>
    <div id="calendar-container">
        <div class="calendar-header">
            <div class="weekday">Monday</div>
            <div class="weekday">Tuesday</div>
            <div class="weekday">Wednesday</div>
            <div class="weekday">Thursday</div>
            <div class="weekday">Friday</div>
        </div>
        <div class="calendar-body" id="calendar-body"></div>
    </div>
    
    <script>
        const calendarBody = document.getElementById('calendar-body');
        const timeSlotsPerDay = 16;  // 9:00 AM to 5:00 PM in 30-minute intervals
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        
        // Initialize the calendar body with time slots
        for (let i = 0; i < timeSlotsPerDay; i++) {
            for (let j = 0; j < days.length; j++) {
                const slotIndex = i + j * timeSlotsPerDay;
                const timeSlot = document.createElement('div');
                timeSlot.classList.add('time-slot');
                timeSlot.dataset.index = slotIndex;
                timeSlot.dataset.day = days[j];
                calendarBody.appendChild(timeSlot);
            }
        }

        let isDragging = false;
        let startSlot = null;
        let currentEvent = null;

        calendarBody.addEventListener('mousedown', (e) => {
            const target = e.target;
            if (target.classList.contains('time-slot')) {
                isDragging = true;
                startSlot = target;
                currentEvent = document.createElement('div');
                currentEvent.classList.add('event');
                updateEventTimeRange(currentEvent, startSlot.dataset.index, startSlot.dataset.index);
                target.appendChild(currentEvent);
            }
        });

        calendarBody.addEventListener('mousemove', (e) => {
            if (isDragging && startSlot) {
                const target = document.elementFromPoint(e.clientX, e.clientY);
                if (target && target.classList.contains('time-slot')) {
                    const startIndex = parseInt(startSlot.dataset.index);
                    const endIndex = parseInt(target.dataset.index);
                    updateEventTimeRange(currentEvent, startIndex, endIndex);
                }
            }
        });

        calendarBody.addEventListener('mouseup', (e) => {
            if (isDragging) {
                isDragging = false;
                currentEvent.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const confirmDelete = confirm('Do you want to delete this event?');
                    if (confirmDelete) {
                        currentEvent.remove();
                    }
                });
                startSlot = null;
                currentEvent = null;
            }
        });

        function updateEventTimeRange(eventElement, startIndex, endIndex) {
            const minIndex = Math.min(startIndex, endIndex);
            const maxIndex = Math.max(startIndex, endIndex);
            const startTop = (minIndex % timeSlotsPerDay) * 30;
            const endTop = ((maxIndex % timeSlotsPerDay) + 1) * 30;
            const height = endTop - startTop;
            const dayColumn = Math.floor(minIndex / timeSlotsPerDay);
            
            eventElement.style.top = `${startTop}px`;
            eventElement.style.height = `${height}px`;
            eventElement.style.lineHeight = `${height / 30}px`;
            eventElement.innerHTML = getEventTimeRange(minIndex, maxIndex);
        }

        function getEventTimeRange(startIndex, endIndex) {
            const start = convertIndexToTime(startIndex);
            const end = convertIndexToTime(endIndex + 1);  // Add 1 to end index to show the correct end time
            return `${start} - ${end}`;
        }

        function convertIndexToTime(index) {
            const hour = Math.floor(index % timeSlotsPerDay / 2) + 9; // 9:00 AM starts
            const minutes = (index % 2) * 30;
            return `${hour.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
    </script>
</body>
</html>