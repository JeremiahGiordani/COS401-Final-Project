<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Calendar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(16, 1fr);
            gap: 1px;
            height: 100vh;
        }
        .calendar div {
            border: 1px solid #ddd;
            position: relative;
        }
        .time-slot {
            height: 60px;
        }
        .event {
            position: absolute;
            background-color: #4caf50;
            color: white;
            padding: 2px;
            box-sizing: border-box;
            cursor: pointer;
        }
        .highlight {
            background-color: rgba(0, 0, 0, 0.1);
        }
        .current-time {
            position: absolute;
            width: 100%;
            border-top: 2px solid red;
        }
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: none;
        }
        .popup input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
        }
        .popup button {
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="calendar" id="calendar">
        <div class="time-slot" data-time="9:00"></div>
        <div class="time-slot" data-time="9:30"></div>
        <div class="time-slot" data-time="10:00"></div>
        <div class="time-slot" data-time="10:30"></div>
        <div class="time-slot" data-time="11:00"></div>
        <div class="time-slot" data-time="11:30"></div>
        <div class="time-slot" data-time="12:00"></div>
        <div class="time-slot" data-time="12:30"></div>
        <div class="time-slot" data-time="1:00"></div>
        <div class="time-slot" data-time="1:30"></div>
        <div class="time-slot" data-time="2:00"></div>
        <div class="time-slot" data-time="2:30"></div>
        <div class="time-slot" data-time="3:00"></div>
        <div class="time-slot" data-time="3:30"></div>
        <div class="time-slot" data-time="4:00"></div>
        <div class="time-slot" data-time="4:30"></div>
    </div>
    <div class="popup" id="popup">
        <input type="text" id="event-name" placeholder="Event Name">
        <button id="save-event">Save</button>
        <button id="cancel-event">Cancel</button>
    </div>
    <script>
        const calendar = document.getElementById('calendar');
        const popup = document.getElementById('popup');
        const eventNameInput = document.getElementById('event-name');
        const saveEventButton = document.getElementById('save-event');
        const cancelEventButton = document.getElementById('cancel-event');
        let startSlot = null;
        let endSlot = null;
        let currentEvent = null;

        calendar.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('time-slot')) {
                startSlot = e.target;
                endSlot = e.target;
                highlightSlots(startSlot, endSlot);
            }
        });

        calendar.addEventListener('mousemove', (e) => {
            if (startSlot && e.target.classList.contains('time-slot')) {
                endSlot = e.target;
                highlightSlots(startSlot, endSlot);
            }
        });

        calendar.addEventListener('mouseup', (e) => {
            if (startSlot && endSlot) {
                createEvent(startSlot, endSlot);
                clearHighlights();
                startSlot = null;
                endSlot = null;
            }
        });

        function highlightSlots(start, end) {
            clearHighlights();
            const slots = Array.from(calendar.children);
            const startIndex = slots.indexOf(start);
            const endIndex = slots.indexOf(end);
            for (let i = Math.min(startIndex, endIndex); i <= Math.max(startIndex, endIndex); i++) {
                slots[i].classList.add('highlight');
            }
        }

        function clearHighlights() {
            const slots = Array.from(calendar.children);
            slots.forEach(slot => slot.classList.remove('highlight'));
        }

        function createEvent(start, end) {
            const event = document.createElement('div');
            event.classList.add('event');
            event.style.top = start.offsetTop + 'px';
            event.style.height = (end.offsetTop - start.offsetTop + start.offsetHeight) + 'px';
            event.style.width = '100%';
            event.dataset.start = start.dataset.time;
            event.dataset.end = end.dataset.time;
            event.textContent = `${start.dataset.time} - ${end.dataset.time}`;
            event.addEventListener('click', () => {
                if (confirm('Delete this event?')) {
                    event.remove();
                }
            });
            calendar.appendChild(event);
            showPopup(event);
        }

        function showPopup(event) {
            currentEvent = event;
            popup.style.display = 'block';
            eventNameInput.value = '';
            eventNameInput.focus();
        }

        saveEventButton.addEventListener('click', () => {
            if (currentEvent) {
                currentEvent.textContent = eventNameInput.value + ' (' + currentEvent.dataset.start + ' - ' + currentEvent.dataset.end + ')';
                popup.style.display = 'none';
                currentEvent = null;
            }
        });

        cancelEventButton.addEventListener('click', () => {
            if (currentEvent) {
                currentEvent.remove();
                popup.style.display = 'none';
                currentEvent = null;
            }
        });

        function showCurrentTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            if (hours >= 9 && hours < 17) {
                const currentTimeLine = document.createElement('div');
                currentTimeLine.classList.add('current-time');
                const top = ((hours - 9) * 60 + minutes) * 2;
                currentTimeLine.style.top = top + 'px';
                calendar.appendChild(currentTimeLine);
            }
        }

        showCurrentTime();
        setInterval(showCurrentTime, 60000);
    </script>
</body>
</html>